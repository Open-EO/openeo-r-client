<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Process Graph Building • openeo</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Process Graph Building">
<meta property="og:description" content="openeo">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openeo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/openeo-01-getting_started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/openeo-02-sample_data.html">Sample Data Retrieval</a>
    </li>
    <li>
      <a href="../articles/openeo-03-package-software-architecture.html">Software and Package Architecture</a>
    </li>
    <li>
      <a href="../articles/openeo-04-process_graph_concepts.html">Process Graph Building</a>
    </li>
    <li>
      <a href="../articles/openeo-05-process_graph_building_application.html">Process Graph Building Application</a>
    </li>
    <li>
      <a href="../articles/openeo-06-developer_implementation_details.html">Developer Implementation Details</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Open-EO/openeo-r-client/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="openeo-04-process_graph_concepts_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Process Graph Building</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Open-EO/openeo-r-client/blob/HEAD/vignettes/openeo-04-process_graph_concepts.Rmd" class="external-link"><code>vignettes/openeo-04-process_graph_concepts.Rmd</code></a></small>
      <div class="hidden name"><code>openeo-04-process_graph_concepts.Rmd</code></div>

    </div>

    
    
<p>In this guide you will familiarize yourself with the concepts of the process graph building in the <code>openeo</code> package with respect to the <a href="https://api.openeo.org/#section/Processes" class="external-link">openEO API</a> and <a href="https://processes.openeo.org/" class="external-link">openEO processes</a> from a user perspective. In the following we will briefly state the logical structure of an openEO process description and how process graphs are created from processes. Afterwards we dive into some detail about the parameters and arguments of processes, especially how this relates to R where function parameters are usually type free.</p>
<p>Note: For demonstration purposes we will use the general definitions of the <em>openEO processes</em> and their descriptions in order to make them easier to understand.</p>
<div class="section level2">
<h2 id="concepts">Concepts<a class="anchor" aria-label="anchor" href="#concepts"></a>
</h2>
<p>The main idea in openEO is that back-ends provide spatio-temporal data collections, a set of processes specifying how the data shall be manipulated as well as the computing power to process the data accordingly. The data in general is abstracted to be an n-dimensional data cube, more often the used dimensions are spatial (x,y), temporal (t) and there are different bands which denote sensory properties in a categorical way, e.g. a specific wavelength interval for optical measurements or the kind of polarization used in SAR measurements.</p>
<div class="section level3">
<h3 id="processes">Processes<a class="anchor" aria-label="anchor" href="#processes"></a>
</h3>
<p>The openEO API defines processes in a general way, meaning that to be conformant to the API back-ends do not need to implement the whole set of openEO processes, which can be considered to be a set of Good-Practice functions that cover almost all relevant operations on n-dimensional spatio-temporal data. As for this package it means that the “tools” are dependent on the connected back-end and they have to be interpreted dynamically after the connection has been established. The openEO API defines how processes information has to be structured to be interpreted by this package and the openEO processes suggest a set of processes with descriptions and parameters, but the back-end is not obliged to implement or provide any of them. They might even change parameter types or the naming all together.</p>
<p>What remains of it is that all the openEO processes are described in the way the openEO API defines processes.</p>
<p>Now we also need to distinguish between predefined and user-defined processes. The predefined processes are those that are already provided by the back-end and which are implanted ready to be used for processing. The user-defined processes are those process graphs a user can create out of the predefined processes. There we can also define variables to allow for a parametrization, which more or less works like placeholders in the graph that will be filled upon use. This user defined processes can be stored on the back-end <code><a href="../reference/create_user_process.html">create_user_process()</a></code>, which are then only available for the user that have created that processes. Similarly to the initialization of the predefined processes with <code><a href="../reference/processes.html">processes()</a></code>, the users own processes can be loaded by <code><a href="../reference/user_processes.html">user_processes()</a></code>. The user defined processes can then also be used as building blocks, hiding more complex functions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Open-EO/openeo-r-client" class="external-link">openeo</a></span><span class="op">)</span></span>
<span><span class="co"># EVI example to create a user-defined processes</span></span>
<span><span class="va">con</span> <span class="op">=</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="st">"openeo.cloud"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/processes.html">processes</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">evi_function</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">context</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">b02</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">b04</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">b08</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="fl">2.5</span><span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">b08</span><span class="op">-</span><span class="va">b04</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">b08</span>,<span class="fl">6</span><span class="op">*</span><span class="va">b04</span>,<span class="op">-</span><span class="fl">7.5</span><span class="op">*</span><span class="va">b02</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="../reference/login.html">login</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">evi_process</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_user_process.html">create_user_process</a></span><span class="op">(</span><span class="va">evi_function</span>,id <span class="op">=</span> <span class="st">"evi"</span>,summary <span class="op">=</span> <span class="st">"Function to be used in a band reducing function with an array of three input values as B02,B04 and B08 of a Sentinel-2 data set."</span><span class="op">)</span></span>
<span><span class="va">evi_process</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="process-graph-and-process-node">Process Graph and Process Node<a class="anchor" aria-label="anchor" href="#process-graph-and-process-node"></a>
</h3>
<p>We have established that user-defined processes and process graphs are the same. By combining the processes, we will create a graph structure. And as graphs consist of nodes, we refer to a process that has been used in a process graph as Process Node. With “used” we mean that the processes parameters have been bound with values. By using a Process Node as input parameter, we create the relations between the Process Nodes and hence the process graph.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Open-EO/openeo-r-client" class="external-link">openeo</a></span><span class="op">)</span></span>
<span><span class="va">con</span> <span class="op">=</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="st">"openeo.cloud"</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/processes.html">processes</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">coll</span> <span class="op">=</span> <span class="fu"><a href="../reference/list_collections.html">list_collections</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="fu">load_collection</span><span class="op">(</span>id <span class="op">=</span> <span class="va">coll</span><span class="op">$</span><span class="va">SENTINEL2_L2A_SENTINELHUB</span>, bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B02"</span>,<span class="st">"B04"</span>,<span class="st">"B08"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p>The return value is a <code>ProcessNode</code> that is create from the <code>Process</code> as a template during the call of the respective function. Conceptually the <code>ProcessNode</code> is a <code>Process</code> that is extended with the field “nodeId”, which is used to reference this particular step in the graph. Other then that the creation of a <code>ProcessNode</code> via the respective function at the <code>ProcessCollection</code> creates a new R6 object with its own [<code>Argument</code>]. T</p>
<p>Usually, the return values of processes that can be used for relation building is again a n-dimensional data cube (either raster or vector cubes). But there are also processes that either return arrays or single values. Those processes can by itself create also a process graph. They are used in process graph definitions for subroutines like band arithmetic operations, mask creation or aggregation functions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Open-EO/openeo-r-client" class="external-link">openeo</a></span><span class="op">)</span></span>
<span><span class="va">con</span> <span class="op">=</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="st">"openeo.cloud"</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/processes.html">processes</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">coll</span> <span class="op">=</span> <span class="fu"><a href="../reference/list_collections.html">list_collections</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># as starting point: process(argument[s]) --&gt; data</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="fu">load_collection</span><span class="op">(</span>id <span class="op">=</span> <span class="va">coll</span><span class="op">$</span><span class="va">SENTINEL2_L2A_SENTINELHUB</span>,temporal_extent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2021-05-01"</span>,<span class="st">"2021-08-31"</span><span class="op">)</span>, band <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B04"</span>,<span class="st">"B08"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># as modifier: process(data, argument[s]) --&gt; data</span></span>
<span><span class="va">temporal_subset</span> <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="fu">filter_temporal</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, extent<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2021-05-01"</span>,<span class="st">"2021-08-31"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># as modifier with process graph: process(data, arguments, process) --&gt; data</span></span>
<span><span class="va">ndvi_data</span> <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="fu">reduce_dimension</span><span class="op">(</span>data<span class="op">=</span><span class="va">temporal_subset</span>,dimension<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t"</span><span class="op">)</span>,reducer <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">b04</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">b08</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="op">(</span><span class="va">b08</span><span class="op">-</span><span class="va">b04</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">b08</span><span class="op">+</span><span class="va">b04</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># scalar processes</span></span>
<span><span class="va">p</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span>x<span class="op">=</span><span class="fl">2</span>,y<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="co"># usually used in the former R syntax to manipulate data arrays</span></span>
<span></span>
<span><span class="co"># as save / serializer: process(data, argument[s]) --&gt; void</span></span>
<span><span class="va">result</span> <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="fu">save_result</span><span class="op">(</span>data<span class="op">=</span><span class="va">ndvi_data</span>, format <span class="op">=</span> <span class="st">"GTiff"</span><span class="op">)</span></span></code></pre></div>
<p>The openEO processes define some data loading functions, like <code>load_collection</code>, which define starting points in a process graph that is going to be executed to create a result. For the processing at the backend those processes denote points where actual data is loaded into the processing chain. On the other side <code>save_result</code> marks point where data is serialized, which is usually the end of the process graph and contains the data a user wants to obtain as an end result. The following examples shows a process graph that will calculate the minimum value of Enhanced Vegetation Index (EVI) for a data subset. First a data collection was chosen with <code>load_collection</code> and a spatial, temporal and band constraint was applied, which limits the data collection to a specific spatial subset for the given time interval and it also selects the three bands B02, B04 and B08. Then two reduce_dimension operations are performed. The first enables a band arithmetic operation by reducing the bands, which will mean that a reducer function will be applied on each of the remaining cells in x, y and t. This means that the data input of this reducer function will be an array of the measurement values for each band, e.g. [7000,4000,5000] with the order specified in the <code>load_collection</code> function for parameter “band”. The used EVI function was ideally created beforehand and was stored as a user-defined process on the back-end. Then we reduced over the time dimension t, be selecting the minimum in this time period. The input for the minimum aggregation will be again a vector, but this time it already contains the EVI values from the previous step, e.g. [0.3246, 0.3021, 0.2345, 0.1231, 0.3456, 0.4367, 0.6753] where the value corresponds to the recording time of the scene and a natural time order is assumed. The final step stores the result as a GTiff file, which marks also the end of processing.</p>
<p><img src="images/evi-processing.png"></p>
<p>The seed of the graph structure is a single <code>ProcessNode</code> that is not used by another <code>ProcessNode</code> of the graph, this is called the final node. A <code>ProcessNode</code> consists of the id of an openEO process, user-defined values for its parameters, as well as a unique id of the <code>ProcessNode</code> itself. The graph is simply a set of <code>ProcessNode</code>s which are connected to at least one other <code>ProcessNode</code>. We distinguish between the nodes definition and its use by reference. This affects how it is represented (serialized) in the JSON representation of the graph. A reference is serialized as a reference object in JSON like <code>{"from_node":"some_node_id"}</code>. Otherwise the <code>ProcessNode</code> is defined in a schematic way like:</p>
<pre><code>Graph := {
  "nodeId1": &lt;Process&gt;,
  "nodeId2": &lt;Process&gt;
}

Process := {
  "process_id": &lt;ProcessName&gt;
  "arguments": {
    "parameterName1": &lt;Argument&gt;,
    "parameterName2": &lt;Argument&gt;
  }
}

Argument := Value|NodeReference

NodeReference := {
  "from_node":"nodeId2"
}</code></pre>
<p>The transformation of the <code>ProcessNode</code> into a JSON graph is called serialization. This is done by traversing bottom-up through the graph starting at the final node. Each user-defined parameter of the visited <code>ProcessNode</code> is checked if it is a simple value or another <code>ProcessNode</code>. Each of the newly found <code>ProcessNode</code>s is visited in the next step and its arguments are scanned also until there are no new <code>ProcessNode</code>s left. Where a process node was found a reference object will be created, other arguments reflect their value.</p>
<p>The user defined process, which we have defined before (EVI) would look like this:</p>
<pre><code>{
  "array_element_CRUBQ5502B": {
    "process_id": "array_element",
    "arguments": {
      "data": {
        "from_parameter": "x"
      },
      "index": 2,
      "return_nodata": false
    }
  },
  "array_element_HKVTL6105G": {
    "process_id": "array_element",
    "arguments": {
      "data": {
        "from_parameter": "x"
      },
      "index": 1,
      "return_nodata": false
    }
  },
  "subtract_THEWN7421S": {
    "process_id": "subtract",
    "arguments": {
      "x": {
        "from_node": "array_element_CRUBQ5502B"
      },
      "y": {
        "from_node": "array_element_HKVTL6105G"
      }
    }
  },
  "multiply_HFOGI6385B": {
    "process_id": "multiply",
    "arguments": {
      "x": 6,
      "y": {
        "from_node": "array_element_HKVTL6105G"
      }
    }
  },
  "array_element_JCXIO4829E": {
    "process_id": "array_element",
    "arguments": {
      "data": {
        "from_parameter": "x"
      },
      "index": 0,
      "return_nodata": false
    }
  },
  "multiply_CEOJU9730W": {
    "process_id": "multiply",
    "arguments": {
      "x": -7.5,
      "y": {
        "from_node": "array_element_JCXIO4829E"
      }
    }
  },
  "sum_TSXJU2112N": {
    "process_id": "sum",
    "arguments": {
      "data": [
        {
          "from_node": "array_element_CRUBQ5502B"
        },
        {
          "from_node": "multiply_HFOGI6385B"
        },
        {
          "from_node": "multiply_CEOJU9730W"
        },
        1
      ],
      "ignore_nodata": false
    }
  },
  "divide_KYDNA4078A": {
    "process_id": "divide",
    "arguments": {
      "x": {
        "from_node": "subtract_THEWN7421S"
      },
      "y": {
        "from_node": "sum_TSXJU2112N"
      }
    }
  },
  "multiply_HIVAA9923I": {
    "process_id": "multiply",
    "arguments": {
      "x": 2.5,
      "y": {
        "from_node": "divide_KYDNA4078A"
      }
    },
    "result": true
  }
} </code></pre>
<p>The single “load_collection” process node would look like this:</p>
<pre><code>{
  "process_id": "load_collection",
  "arguments": {
    "id": "SENTINEL2_L2A_SENTINELHUB",
    "temporal_extent": [
      "2021-05-01",
      "2021-08-31"
    ],
    "bands": [
      "B04",
      "B08"
    ]
  }
}</code></pre>
<p>and as Process:</p>
<pre><code>{
  "process_graph": {
    "load_collection_XGXUY9528Y": {
      "process_id": "load_collection",
      "arguments": {
        "id": "SENTINEL2_L2A_SENTINELHUB",
        "temporal_extent": [
          "2021-05-01",
          "2021-08-31"
        ],
        "bands": [
          "B04",
          "B08"
        ]
      },
      "result": true
    }
  },
  "parameters": [],
  "returns": {
    "schema": {
      "type": "object",
      "subtype": "raster-cube"
    }
  }
} </code></pre>
</div>
<div class="section level3">
<h3 id="arguments-and-parameters">Arguments and Parameters<a class="anchor" aria-label="anchor" href="#arguments-and-parameters"></a>
</h3>
<p>All the processes offer various kinds of parameters so the user can control the process. One parameter, usually “data”, transports the input data that will be manipulated. If the parameter type is a raster or vector cube the whole n-dimensional data cube will be manipulated. But it is also possible to manipulate arrays or scalars of data. This kind of input is often times transferred to the process, when a process graph is allowed as value for the parameter. The user-defined process that is passed to that parameter needs to accept the parameters provided “process graph parameters” as input.</p>
<p>The other controlling parameters can have a <a href="https://github.com/Open-EO/openeo-processes/blob/master/meta/subtype-schemas.json" class="external-link">variety of types</a>.</p>
<p>To clarify, the parameter type matching is completely hidden from the user. A user simply tries to pass a value to a process parameter and the most suitable allowed parameter type is chosen automatically. If the value cannot be matched to the allowed types for the parameter, then at some point a warning or an error will be raised. To inform yourself about the allowed parameter types, please look up the process descriptions.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/describe_process.html">describe_process</a></span><span class="op">(</span><span class="st">"load_collection"</span><span class="op">)</span></span></code></pre></div>
`
<script>
if (!window.customElements || !window.customElements.get('openeo-process')) {{
    var el = document.createElement('script');
    el.src = "https://cdn.jsdelivr.net/npm/@openeo/vue-components@2/assets/openeo.min.js";
    document.head.appendChild(el);
}}

var css = `@font-face { font-family: 'Font Awesome 5 Free'; font-style: normal; font-weight: 900; font-display: block; src: url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/webfonts/fa-solid-900.woff2) format("woff2") }`;
if(!document.getElementById('openeo-vue-components-fa')){
  style = document.createElement('style');
  style.id = 'openeo-vue-components-fa';
  style.type = 'text/css';
  style.innerText = css;
  document.head.appendChild(style);
}
</script><style type="text/css">
.rmd {
  max-height: 90vh;
  overflow: auto;
  display: block;
  margin: 1em 0;
}
</style>
<openeo-process style="font-family: sans-serif;" class="rmd"><script type="application/json">{"show-graph":true,"provide-download":false,"process":{"id":"load_collection","summary":"Load a collection","description":"Loads a collection from the current back-end by its id and returns it as a processable data cube. The data that is added to the data cube can be restricted with the parameters `spatial_extent`, `temporal_extent`, `bands` and `properties`.\n\n**Remarks:**\n\n* The bands (and all dimensions that specify nominal dimension labels) are expected to be ordered as specified in the metadata if the `bands` parameter is set to `null`.\n* If no additional parameter is specified this would imply that the whole data set is expected to be loaded. Due to the large size of many data sets, this is not recommended and may be optimized by back-ends to only load the data that is actually required after evaluating subsequent processes such as filters. This means that the pixel values should be processed only after the data has been limited to the required extent and as a consequence also to a manageable size.","categories":["cubes","import"],"parameters":[{"name":"id","description":"The collection id.","schema":{"type":"string","subtype":"collection-id","pattern":"^[\\w\\-\\.~/]+$"}},{"name":"spatial_extent","description":"Limits the data to load from the collection to the specified bounding box or polygons.\n\nThe process puts a pixel into the data cube if the point at the pixel center intersects with the bounding box or any of the polygons (as defined in the Simple Features standard by the OGC).\n\nThe GeoJSON can be one of the following feature types:\n\n* A `Polygon` or `MultiPolygon` geometry,\n* a `Feature` with a `Polygon` or `MultiPolygon` geometry,\n* a `FeatureCollection` containing at least one `Feature` with `Polygon` or `MultiPolygon` geometries, or\n* a `GeometryCollection` containing `Polygon` or `MultiPolygon` geometries. To maximize interoperability, `GeometryCollection` should be avoided in favour of one of the alternatives above.\n\nSet this parameter to `null` to set no limit for the spatial extent. Be careful with this when loading large datasets! It is recommended to use this parameter instead of using ``filter_bbox()`` or ``filter_spatial()`` directly after loading unbounded data.","schema":[{"title":"Bounding Box","type":"object","subtype":"bounding-box","required":["west","south","east","north"],"properties":{"west":{"description":"West (lower left corner, coordinate axis 1).","type":"number"},"south":{"description":"South (lower left corner, coordinate axis 2).","type":"number"},"east":{"description":"East (upper right corner, coordinate axis 1).","type":"number"},"north":{"description":"North (upper right corner, coordinate axis 2).","type":"number"},"base":{"description":"Base (optional, lower left corner, coordinate axis 3).","type":["number","null"],"default":null},"height":{"description":"Height (optional, upper right corner, coordinate axis 3).","type":["number","null"],"default":null},"crs":{"description":"Coordinate reference system of the extent, specified as as [EPSG code](http://www.epsg-registry.org/), [WKT2 (ISO 19162) string](http://docs.opengeospatial.org/is/18-010r7/18-010r7.html) or [PROJ definition (deprecated)](https://proj.org/usage/quickstart.html). Defaults to `4326` (EPSG code 4326) unless the client explicitly requests a different coordinate reference system.","anyOf":[{"title":"EPSG Code","type":"integer","subtype":"epsg-code","minimum":1000,"examples":[3857]},{"title":"WKT2","type":"string","subtype":"wkt2-definition"},{"title":"PROJ definition","type":"string","subtype":"proj-definition","deprecated":true}],"default":4326}}},{"title":"GeoJSON","description":"Limits the data cube to the bounding box of the given geometry. All pixels inside the bounding box that do not intersect with any of the polygons will be set to no data (`null`).","type":"object","subtype":"geojson"},{"title":"No filter","description":"Don't filter spatially. All data is included in the data cube.","type":"null"}]},{"name":"temporal_extent","description":"Limits the data to load from the collection to the specified left-closed temporal interval. Applies to all temporal dimensions. The interval has to be specified as an array with exactly two elements:\n\n1. The first element is the start of the temporal interval. The specified instance in time is **included** in the interval.\n2. The second element is the end of the temporal interval. The specified instance in time is **excluded** from the interval.\n\nThe specified temporal strings follow [RFC 3339](https://www.rfc-editor.org/rfc/rfc3339.html). Also supports open intervals by setting one of the boundaries to `null`, but never both.\n\nSet this parameter to `null` to set no limit for the temporal extent. Be careful with this when loading large datasets! It is recommended to use this parameter instead of using ``filter_temporal()`` directly after loading unbounded data.","schema":[{"type":"array","subtype":"temporal-interval","minItems":2,"maxItems":2,"items":{"anyOf":[{"type":"string","format":"date-time","subtype":"date-time"},{"type":"string","format":"date","subtype":"date"},{"type":"string","subtype":"year","minLength":4,"maxLength":4,"pattern":"^\\d{4}$"},{"type":"null"}]},"examples":[["2015-01-01T00:00:00Z","2016-01-01T00:00:00Z"],["2015-01-01","2016-01-01"]]},{"title":"No filter","description":"Don't filter temporally. All data is included in the data cube.","type":"null"}]},{"name":"bands","description":"Only adds the specified bands into the data cube so that bands that don't match the list of band names are not available. Applies to all dimensions of type `bands`.\n\nEither the unique band name (metadata field `name` in bands) or one of the common band names (metadata field `common_name` in bands) can be specified. If the unique band name and the common name conflict, the unique band name has a higher priority.\n\nThe order of the specified array defines the order of the bands in the data cube. If multiple bands match a common name, all matched bands are included in the original order.\n\nIt is recommended to use this parameter instead of using ``filter_bands()`` directly after loading unbounded data.","schema":[{"type":"array","items":{"type":"string","subtype":"band-name"}},{"title":"No filter","description":"Don't filter bands. All bands are included in the data cube.","type":"null"}],"default":null,"optional":true},{"name":"properties","description":"Limits the data by metadata properties to include only data in the data cube which all given conditions return `true` for (AND operation).\n\nSpecify key-value-pairs with the key being the name of the metadata property, which can be retrieved with the openEO Data Discovery for Collections. The value must be a condition (user-defined process) to be evaluated against the collection metadata, see the example.","schema":[{"type":"object","subtype":"metadata-filter","title":"Filters","description":"A list of filters to check against. Specify key-value-pairs with the key being the name of the metadata property name and the value being a process evaluated against the metadata values.","additionalProperties":{"type":"object","subtype":"process-graph","parameters":[{"name":"value","description":"The property value to be checked against.","schema":{"description":"Any data type."}}],"returns":{"description":"`true` if the data should be loaded into the data cube, otherwise `false`.","schema":{"type":"boolean"}}}},{"title":"No filter","description":"Don't filter by metadata properties.","type":"null"}],"default":null,"optional":true}],"returns":{"description":"A data cube for further processing. The dimensions and dimension properties (name, type, labels, reference system and resolution) correspond to the collection's metadata, but the dimension labels are restricted as specified in the parameters.","schema":{"type":"object","subtype":"raster-cube"}},"links":[{"href":"https://openeo.org/documentation/1.0/datacubes.html","rel":"about","title":"Data Cubes explained in the openEO documentation"},{"rel":"about","href":"https://proj.org/usage/projections.html","title":"PROJ parameters for cartographic projections"},{"rel":"about","href":"http://www.epsg-registry.org","title":"Official EPSG code registry"},{"rel":"about","href":"http://www.epsg.io","title":"Unofficial EPSG code database"},{"href":"http://www.opengeospatial.org/standards/sfa","rel":"about","title":"Simple Features standard by the OGC"},{"rel":"about","href":"https://github.com/radiantearth/stac-spec/tree/master/extensions/eo#common-band-names","title":"List of common band names as specified by the STAC specification"}]}}</script><p></p></openeo-process>`{=html}
<div class="section level4">
<h4 id="parameter-manipulation">Parameter manipulation<a class="anchor" aria-label="anchor" href="#parameter-manipulation"></a>
</h4>
<p>In order to set the values for the parameters of the processes you can use the builder functions of the <code>ProcessCollection</code>, where you can pass arguments as the function parameters.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1; sf_use_s2() is TRUE</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/processes.html">processes</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bbox</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin<span class="op">=</span><span class="fl">7</span>,xmax<span class="op">=</span><span class="fl">7.5</span>,ymin<span class="op">=</span><span class="fl">52</span>,ymax<span class="op">=</span><span class="fl">52.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">bbox</span><span class="op">)</span> <span class="op">=</span> <span class="fl">4326</span></span>
<span></span>
<span><span class="va">dc</span> <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="fu">load_collection</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"S2"</span>, spatial_extent <span class="op">=</span> <span class="va">bbox</span>,temporal_extent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"2022-05-20"</span>,<span class="st">"2022-06-10"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dc</span></span></code></pre></div>
<pre><code><span><span class="co">## {</span></span>
<span><span class="co">##   "process_id": "load_collection",</span></span>
<span><span class="co">##   "arguments": {</span></span>
<span><span class="co">##     "id": "S2",</span></span>
<span><span class="co">##     "spatial_extent": {</span></span>
<span><span class="co">##       "west": 7,</span></span>
<span><span class="co">##       "east": 7.5,</span></span>
<span><span class="co">##       "south": 52,</span></span>
<span><span class="co">##       "north": 52.5</span></span>
<span><span class="co">##     },</span></span>
<span><span class="co">##     "temporal_extent": [</span></span>
<span><span class="co">##       "2022-05-20",</span></span>
<span><span class="co">##       "2022-06-10"</span></span>
<span><span class="co">##     ]</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">## }</span></span></code></pre>
<p>As a second option you can manipulate the parameters of the process node by interacting with the field <code>parameters</code> of <code>ProcessNode</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dc</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">bands</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B04"</span>,<span class="st">"B08"</span><span class="op">)</span></span>
<span><span class="va">dc</span></span></code></pre></div>
<pre><code><span><span class="co">## {</span></span>
<span><span class="co">##   "process_id": "load_collection",</span></span>
<span><span class="co">##   "arguments": {</span></span>
<span><span class="co">##     "id": "S2",</span></span>
<span><span class="co">##     "spatial_extent": {</span></span>
<span><span class="co">##       "west": 7,</span></span>
<span><span class="co">##       "east": 7.5,</span></span>
<span><span class="co">##       "south": 52,</span></span>
<span><span class="co">##       "north": 52.5</span></span>
<span><span class="co">##     },</span></span>
<span><span class="co">##     "temporal_extent": [</span></span>
<span><span class="co">##       "2022-05-20",</span></span>
<span><span class="co">##       "2022-06-10"</span></span>
<span><span class="co">##     ],</span></span>
<span><span class="co">##     "bands": [</span></span>
<span><span class="co">##       "B04",</span></span>
<span><span class="co">##       "B08"</span></span>
<span><span class="co">##     ]</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">## }</span></span></code></pre>
<p>The values can also replace existing values, in the same way.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dc</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">temporal_extent</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2022-05-01"</span>,<span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">dc</span></span></code></pre></div>
<pre><code><span><span class="co">## {</span></span>
<span><span class="co">##   "process_id": "load_collection",</span></span>
<span><span class="co">##   "arguments": {</span></span>
<span><span class="co">##     "id": "S2",</span></span>
<span><span class="co">##     "spatial_extent": {</span></span>
<span><span class="co">##       "west": 7,</span></span>
<span><span class="co">##       "east": 7.5,</span></span>
<span><span class="co">##       "south": 52,</span></span>
<span><span class="co">##       "north": 52.5</span></span>
<span><span class="co">##     },</span></span>
<span><span class="co">##     "temporal_extent": [</span></span>
<span><span class="co">##       "2022-05-01",</span></span>
<span><span class="co">##       null</span></span>
<span><span class="co">##     ],</span></span>
<span><span class="co">##     "bands": [</span></span>
<span><span class="co">##       "B04",</span></span>
<span><span class="co">##       "B08"</span></span>
<span><span class="co">##     ]</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">## }</span></span></code></pre>
<p>Of course, you can simply return the current value for a parameter as well.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dc</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">spatial_extent</span></span></code></pre></div>
<pre><code><span><span class="co">## xmin ymin xmax ymax </span></span>
<span><span class="co">##  7.0 52.0  7.5 52.5</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="variables">Variables<a class="anchor" aria-label="anchor" href="#variables"></a>
</h4>
<p>Another useful function is the concept of variables. Those are considered to be placeholder for certain arguments.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bbox_var</span> <span class="op">=</span> <span class="fu"><a href="../reference/create_variable.html">create_variable</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"bbox"</span>,description <span class="op">=</span> <span class="st">"The bounding box of the process graph"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dc</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">spatial_extent</span> <span class="op">=</span> <span class="va">bbox_var</span></span>
<span><span class="va">dc</span></span></code></pre></div>
<pre><code><span><span class="co">## {</span></span>
<span><span class="co">##   "process_id": "load_collection",</span></span>
<span><span class="co">##   "arguments": {</span></span>
<span><span class="co">##     "id": "S2",</span></span>
<span><span class="co">##     "spatial_extent": {</span></span>
<span><span class="co">##       "from_parameter": "bbox"</span></span>
<span><span class="co">##     },</span></span>
<span><span class="co">##     "temporal_extent": [</span></span>
<span><span class="co">##       "2022-05-01",</span></span>
<span><span class="co">##       null</span></span>
<span><span class="co">##     ],</span></span>
<span><span class="co">##     "bands": [</span></span>
<span><span class="co">##       "B04",</span></span>
<span><span class="co">##       "B08"</span></span>
<span><span class="co">##     ]</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">## }</span></span></code></pre>
<p>When creating parameterized user-defined processes the variables are used as the functions input parameter.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ndvi_prep_loader</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">dc</span>,<span class="st">"Process"</span><span class="op">)</span></span>
<span><span class="va">ndvi_prep_loader</span></span></code></pre></div>
`
<script>
if (!window.customElements || !window.customElements.get('openeo-process')) {{
    var el = document.createElement('script');
    el.src = "https://cdn.jsdelivr.net/npm/@openeo/vue-components@2/assets/openeo.min.js";
    document.head.appendChild(el);
}}

var css = `@font-face { font-family: 'Font Awesome 5 Free'; font-style: normal; font-weight: 900; font-display: block; src: url(https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/webfonts/fa-solid-900.woff2) format("woff2") }`;
if(!document.getElementById('openeo-vue-components-fa')){
  style = document.createElement('style');
  style.id = 'openeo-vue-components-fa';
  style.type = 'text/css';
  style.innerText = css;
  document.head.appendChild(style);
}
</script><style type="text/css">
.rmd {
  max-height: 90vh;
  overflow: auto;
  display: block;
  margin: 1em 0;
}
</style>
<openeo-process style="font-family: sans-serif;" class="rmd"><script type="application/json">{"show-graph":true,"provide-download":false,"process":{"process_graph":{"load_collection_HXNCB3848A":{"process_id":"load_collection","arguments":{"id":"S2","spatial_extent":{"from_parameter":"bbox"},"temporal_extent":["2022-05-01",null],"bands":["B04","B08"]},"result":true}},"parameters":[],"returns":{"schema":{"type":"object","subtype":"raster-cube"}}}}</script><p></p></openeo-process>`{=html}
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Florian Lahn.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
